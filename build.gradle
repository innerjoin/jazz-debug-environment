apply plugin: 'java'

import org.gradle.internal.os.OperatingSystem;

task detect {
    doLast {
        println("Linux: " + OperatingSystem.current().isLinux())
        println("Windows: " + OperatingSystem.current().isWindows())
    }
}

task cleanup {
    doLast {
        if (OperatingSystem.current().isWindows()) {
            exec {
                commandLine 'powershell.exe', './clean.ps1'
            }
        }

        if (OperatingSystem.current().isLinux()) {
            exec {
                commandLine './clean.sh'
            }
        }
    }
}

task generate {
    doLast {
        if (OperatingSystem.current().isWindows()) {
            exec {
                workingDir 'conf/jetty'
                commandLine 'powershell.exe', './generate_jetty_config.ps1'
            }
        }

        if (OperatingSystem.current().isLinux()) {
            exec {
                workingDir './conf/jetty'
                commandLine './generate_jetty_config.sh'
                ignoreExitValue true
            }
        }
    }
}

task run2(type: Exec) {
    if (OperatingSystem.current().isWindows()) {
        workingDir './'
        commandLine 'cmd', '/K', 'start', 'powershell','./run_jetty.ps1'
    }

    if (OperatingSystem.current().isLinux()) {
    }

}
